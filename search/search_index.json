{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home \u00b6 Disclaimer This Splunk app is not affiliated with Pi-hole \u00ae and is not sponsored or sanctioned by the Pi-hole\u00ae team. As such, the included documentation does not contain information on how to get started with the Pi-hole DNS server. Rather, this documentation serves as a guide to help visualize the data in Splunk. Please visit https://pi-hole.net for documentation on installing/configuring your own Pi-hole server. Pi-hole is and the Pi-hole logo are registered trademarks of Pi-hole LLC. Visualize your Pi-hole in Splunk! If you've landed on this app, it's probably because you are running your own super awesome Pi-hole\u00ae server. If not, check it out! https://pi-hole.net/ This app works with the Pihole DNS Add-on add-on which provides the field extractions necessary for this app. Key Features \u00b6 Allows for easier troubleshooting of blocked queries. Prebuilt dashboards that allows you to drill-down to specific queries for further analysis. View daily trends and easily identify if queries are outside the month's norm. Test Regex filters before applying them on the Pi-hole server. View a list of all DHCP clients. Identify errors that may be a result of a misconfiguration. Check the DNS queries across all Pi-hole instances in a single place. View Allow and Deny filters setup across all Pi-hole servers. and more! Assumptions \u00b6 This documentation assumes the following: You have a working Pi-hole server. You have a working Splunk environment. Basic understanding of Splunk and Pi-hole. The Pihole DNS Add-on for Splunk has been installed and configured. About \u00b6 See Release Notes for version specific information. Info Description Version 2.2.2 - Splunkbase | GitHub Vendor Product Version Pi-hole\u00ae 5.x, FTL 5.x Get Started","title":"Home"},{"location":"#home","text":"Disclaimer This Splunk app is not affiliated with Pi-hole \u00ae and is not sponsored or sanctioned by the Pi-hole\u00ae team. As such, the included documentation does not contain information on how to get started with the Pi-hole DNS server. Rather, this documentation serves as a guide to help visualize the data in Splunk. Please visit https://pi-hole.net for documentation on installing/configuring your own Pi-hole server. Pi-hole is and the Pi-hole logo are registered trademarks of Pi-hole LLC. Visualize your Pi-hole in Splunk! If you've landed on this app, it's probably because you are running your own super awesome Pi-hole\u00ae server. If not, check it out! https://pi-hole.net/ This app works with the Pihole DNS Add-on add-on which provides the field extractions necessary for this app.","title":"Home"},{"location":"#key-features","text":"Allows for easier troubleshooting of blocked queries. Prebuilt dashboards that allows you to drill-down to specific queries for further analysis. View daily trends and easily identify if queries are outside the month's norm. Test Regex filters before applying them on the Pi-hole server. View a list of all DHCP clients. Identify errors that may be a result of a misconfiguration. Check the DNS queries across all Pi-hole instances in a single place. View Allow and Deny filters setup across all Pi-hole servers. and more!","title":"Key Features"},{"location":"#assumptions","text":"This documentation assumes the following: You have a working Pi-hole server. You have a working Splunk environment. Basic understanding of Splunk and Pi-hole. The Pihole DNS Add-on for Splunk has been installed and configured.","title":"Assumptions"},{"location":"#about","text":"See Release Notes for version specific information. Info Description Version 2.2.2 - Splunkbase | GitHub Vendor Product Version Pi-hole\u00ae 5.x, FTL 5.x Get Started","title":"About"},{"location":"getting-started/app-dependencies/","text":"App Dependencies \u00b6 The following table describes the Apps that are needed to utilize the full capabilities of the app. Please install and configure these apps prior to deploying this app. Danger, Will Robinson Failure to install any of the below apps/add-ons will cause this app to not function as intended. Splunkbase App Description Pihole DNS Add-on (TA-pihole_dns) Technical Add-on needed for Splunk to correctly parse the Pi-hole data. Splunk Common Information Model The Splunk CIM normalizes the data into datamodels which this app leverages for performance. Force Directed App for Splunk Visualization utilized in dashboards. Status Indicator - Custom Visualizatioin Visualization utilized in dashboards.","title":"App Dependencies"},{"location":"getting-started/app-dependencies/#app-dependencies","text":"The following table describes the Apps that are needed to utilize the full capabilities of the app. Please install and configure these apps prior to deploying this app. Danger, Will Robinson Failure to install any of the below apps/add-ons will cause this app to not function as intended. Splunkbase App Description Pihole DNS Add-on (TA-pihole_dns) Technical Add-on needed for Splunk to correctly parse the Pi-hole data. Splunk Common Information Model The Splunk CIM normalizes the data into datamodels which this app leverages for performance. Force Directed App for Splunk Visualization utilized in dashboards. Status Indicator - Custom Visualizatioin Visualization utilized in dashboards.","title":"App Dependencies"},{"location":"getting-started/where-to-install/","text":"Where to Install \u00b6 Standalone Deployments \u00b6 Install this app to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment Distributed Deployments \u00b6 Splunk Instance type Supported Required Comments Search Heads Yes Yes Install this app on search heads. Indexers No No This app does not require installation on indexers. Heavy Forwarders No No There is no need to install this app on Heavy Forwarders. Universal Forwarders No No This app should not be installed on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment","title":"Where to Install"},{"location":"getting-started/where-to-install/#where-to-install","text":"","title":"Where to Install"},{"location":"getting-started/where-to-install/#standalone-deployments","text":"Install this app to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment","title":"Standalone Deployments"},{"location":"getting-started/where-to-install/#distributed-deployments","text":"Splunk Instance type Supported Required Comments Search Heads Yes Yes Install this app on search heads. Indexers No No This app does not require installation on indexers. Heavy Forwarders No No There is no need to install this app on Heavy Forwarders. Universal Forwarders No No This app should not be installed on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment","title":"Distributed Deployments"},{"location":"getting-started/configure/configure-dma/","text":"Data Model Acceleration \u00b6 Optional Step Enabling Data model acceleration ( DMA ) will allow the searches to perform much more efficiently for larger datasets. If you run into issues with dashboards taking too long to load, data model acceleration will increase performance with a slight increase to resource usage. To learn more about data model acceleration see Splunk Docs: Accelerate data models . Enable Acceleration \u00b6 Before enabling Data model acceleration, ensure your dns index has been allowed on the CIM add-on list of indexes. In Splunk web, Navigate to Apps > Manage Apps. Find the App \"Splunk Common Information Model\" and click set up on the right side. Select the \"Network Resolution\" data model. Enter the name of the index being used for the pihole data in the \"Indexes whitelist\" field. This will allow only the indexes listed to be accelerated. If you are ingesting DNS data into other indexes and also want them to be included in the acceleration, list them here as well. Tip To quickly identify which indexes are being used for this data model, the following query can be run: | tstats count from datamodel=Network_Resolution.DNS where index=* by index Once the appropriate indexes are listed, check the \"Accelerate\" box at the top and save. The data model will begin to build. This may take some time depending on the size. Update the pihole_summariesonly macro to \"summariesonly=true\". Setting this will force the dashboards to use accelerated data only, optimizing the searches. see Update Macros in this documentation for more information.","title":"Setup Data Model Acceleration"},{"location":"getting-started/configure/configure-dma/#data-model-acceleration","text":"Optional Step Enabling Data model acceleration ( DMA ) will allow the searches to perform much more efficiently for larger datasets. If you run into issues with dashboards taking too long to load, data model acceleration will increase performance with a slight increase to resource usage. To learn more about data model acceleration see Splunk Docs: Accelerate data models .","title":"Data Model Acceleration"},{"location":"getting-started/configure/configure-dma/#enable-acceleration","text":"Before enabling Data model acceleration, ensure your dns index has been allowed on the CIM add-on list of indexes. In Splunk web, Navigate to Apps > Manage Apps. Find the App \"Splunk Common Information Model\" and click set up on the right side. Select the \"Network Resolution\" data model. Enter the name of the index being used for the pihole data in the \"Indexes whitelist\" field. This will allow only the indexes listed to be accelerated. If you are ingesting DNS data into other indexes and also want them to be included in the acceleration, list them here as well. Tip To quickly identify which indexes are being used for this data model, the following query can be run: | tstats count from datamodel=Network_Resolution.DNS where index=* by index Once the appropriate indexes are listed, check the \"Accelerate\" box at the top and save. The data model will begin to build. This may take some time depending on the size. Update the pihole_summariesonly macro to \"summariesonly=true\". Setting this will force the dashboards to use accelerated data only, optimizing the searches. see Update Macros in this documentation for more information.","title":"Enable Acceleration"},{"location":"getting-started/configure/configure-enrichment/","text":"Configure Enrichment \u00b6 Optional Step This app can automatically enrich IPs with hostnames populated from DHCP events. This step can be skipped if enrichment is not required. The steps to setup enrichment for this app utilize Splunk Lookups. For more information on lookups see Splunk Docs: About lookups . Pi-hole DHCP Enrichment Configuration \u00b6 Note The following steps only apply if you are using your Pi-hole server as your DHCP server. If you are not using the Pi-hole as your DHCP server, see Alternative Enrichment Configuration . For the built-in DHCP hostname enrichment to work, there is a scheduled search that needs to be enabled (Disabled by default) . Search Name Description Default Schedule Pihole - DHCP Leases Lookup - Gen Recurring search to keep DHCP leases up to date. Runs Hourly From Splunk Web, open the Pihole DNS App for Splunk. Navigate to Settings > Searches, Reports, and Alerts. Ensure the \"App\" context is the Pihole DNS App for Splunk by using the dropdown. Set the \"Owner\" to \"all\" Enable by clicking \"Edit\" > \"Enable\" Click \"Run\" Clicking Run will build the lookup for the first time. After that, the lookup will run hourly to keep the information up to date. The frequency that the search runs can be updated by the following: From the same screen, click Edit > Edit Schedule. Update the schedule as needed. Alternative Enrichment Configuration \u00b6 Static Lookup File \u00b6 Using a static lookup file may be the simplest way to get started for enriching IPs with hostnames. The static list takes more to maintain but is easier to get started. If your environment utilizes static IPs or DHCP reservations, this option is the easiest choice. Note If you already have a lookup file to map IPs to hostnames, see Use an existing lookup file . Method 1 - Use the Lookup Editor \u00b6 Recommended The lookup editor may be the easiest way to create and mange lookups in Splunk. You can download and install the Lookup Editor from Splunkbase: Lookup Editor . Once installed, the lookup editor can be used to create a new CSV lookup. Open the Lookup Editor in Splunk Web. Click \"Create a New Lookup\" > CSV lookup. Give the lookup a descriptive name. Choose which App context this lookup will be stored in (i.e. Search & Reporting) . Leave the \"User-only\" box unchecked. This will give the lookup the global scope permissions it needs. Create column headers (row 1). This app uses the following for the CSV header, however, any field names can be used. Recomended Headers dest_nt_host,dest_ip,dest_mac Populate the remaining rows with the IP and host information. Once saved, move on to Update Lookup Macros . Method 2 - Create and Upload a new CSV file \u00b6 A lookup file can be created outside of Splunk and then uploaded via the web interface. Use an editor to create a file in CSV format. Create column headers (row 1). This app uses the following for the CSV header, however, any field names can be used. Recomended Headers dest_nt_host,dest_ip,dest_mac Populate the remaining rows with the IP and host information. Be sure to save the file with a .csv extension. Open Splunk Web. Navigate to Settings > Lookups > Lookup table files (click \"+ Add new\") Select the Destination App (i.e. Search & Reporting) . Upload the file. Provide the Destination filename. This can be the same name as the one created (i.e. pihole_lookup.csv) . Once saved, Navigate back to Settings > Lookups > Lookup table files, if you are not already there. Search for the name of the file you just uploaded. Modify the permissions for the file by clicking \"Permissions.\" Select \"All apps (system)\" from the two radio options. Check \"Read\" permissions for Everyone. Write permissions can be given as needed (typically set to admin & power). After saving, move to Update Lookup Macros . Use an existing lookup file \u00b6 If you already have an existing lookup file that contains a mapping of hostnames and IPs, ensure the following: The lookup file has a global scope. Users are able to read the lookup file. If you are using a lookup file and a lookup definition, also ensure the lookup definition has the same permissions as above. Once verified the correct permissions are set, see Update Lookup Macros .","title":"Setup Enrichment"},{"location":"getting-started/configure/configure-enrichment/#configure-enrichment","text":"Optional Step This app can automatically enrich IPs with hostnames populated from DHCP events. This step can be skipped if enrichment is not required. The steps to setup enrichment for this app utilize Splunk Lookups. For more information on lookups see Splunk Docs: About lookups .","title":"Configure Enrichment"},{"location":"getting-started/configure/configure-enrichment/#pi-hole-dhcp-enrichment-configuration","text":"Note The following steps only apply if you are using your Pi-hole server as your DHCP server. If you are not using the Pi-hole as your DHCP server, see Alternative Enrichment Configuration . For the built-in DHCP hostname enrichment to work, there is a scheduled search that needs to be enabled (Disabled by default) . Search Name Description Default Schedule Pihole - DHCP Leases Lookup - Gen Recurring search to keep DHCP leases up to date. Runs Hourly From Splunk Web, open the Pihole DNS App for Splunk. Navigate to Settings > Searches, Reports, and Alerts. Ensure the \"App\" context is the Pihole DNS App for Splunk by using the dropdown. Set the \"Owner\" to \"all\" Enable by clicking \"Edit\" > \"Enable\" Click \"Run\" Clicking Run will build the lookup for the first time. After that, the lookup will run hourly to keep the information up to date. The frequency that the search runs can be updated by the following: From the same screen, click Edit > Edit Schedule. Update the schedule as needed.","title":"Pi-hole DHCP Enrichment Configuration"},{"location":"getting-started/configure/configure-enrichment/#alternative-enrichment-configuration","text":"","title":"Alternative Enrichment Configuration"},{"location":"getting-started/configure/configure-enrichment/#static-lookup-file","text":"Using a static lookup file may be the simplest way to get started for enriching IPs with hostnames. The static list takes more to maintain but is easier to get started. If your environment utilizes static IPs or DHCP reservations, this option is the easiest choice. Note If you already have a lookup file to map IPs to hostnames, see Use an existing lookup file .","title":"Static Lookup File"},{"location":"getting-started/configure/configure-enrichment/#method-1-use-the-lookup-editor","text":"Recommended The lookup editor may be the easiest way to create and mange lookups in Splunk. You can download and install the Lookup Editor from Splunkbase: Lookup Editor . Once installed, the lookup editor can be used to create a new CSV lookup. Open the Lookup Editor in Splunk Web. Click \"Create a New Lookup\" > CSV lookup. Give the lookup a descriptive name. Choose which App context this lookup will be stored in (i.e. Search & Reporting) . Leave the \"User-only\" box unchecked. This will give the lookup the global scope permissions it needs. Create column headers (row 1). This app uses the following for the CSV header, however, any field names can be used. Recomended Headers dest_nt_host,dest_ip,dest_mac Populate the remaining rows with the IP and host information. Once saved, move on to Update Lookup Macros .","title":"Method 1 - Use the Lookup Editor"},{"location":"getting-started/configure/configure-enrichment/#method-2-create-and-upload-a-new-csv-file","text":"A lookup file can be created outside of Splunk and then uploaded via the web interface. Use an editor to create a file in CSV format. Create column headers (row 1). This app uses the following for the CSV header, however, any field names can be used. Recomended Headers dest_nt_host,dest_ip,dest_mac Populate the remaining rows with the IP and host information. Be sure to save the file with a .csv extension. Open Splunk Web. Navigate to Settings > Lookups > Lookup table files (click \"+ Add new\") Select the Destination App (i.e. Search & Reporting) . Upload the file. Provide the Destination filename. This can be the same name as the one created (i.e. pihole_lookup.csv) . Once saved, Navigate back to Settings > Lookups > Lookup table files, if you are not already there. Search for the name of the file you just uploaded. Modify the permissions for the file by clicking \"Permissions.\" Select \"All apps (system)\" from the two radio options. Check \"Read\" permissions for Everyone. Write permissions can be given as needed (typically set to admin & power). After saving, move to Update Lookup Macros .","title":"Method 2 - Create and Upload a new CSV file"},{"location":"getting-started/configure/configure-enrichment/#use-an-existing-lookup-file","text":"If you already have an existing lookup file that contains a mapping of hostnames and IPs, ensure the following: The lookup file has a global scope. Users are able to read the lookup file. If you are using a lookup file and a lookup definition, also ensure the lookup definition has the same permissions as above. Once verified the correct permissions are set, see Update Lookup Macros .","title":"Use an existing lookup file"},{"location":"getting-started/configure/configure-macros/","text":"Update Search Macros \u00b6 Recommended Step To ensure this App functions efficiently, it is important to update a few search macros. Change the following macros to their appropriate values. For more information on the search macros used in this app, see Search Macros Reference . How to Update Macros \u00b6 Open the Pihole DNS app for Splunk. Navigate to Settings > Advanced Search > Search macros. Not seeing any results If no results are found, be sure that the \"App\" context is set to the Pihole DNS app, owner is set to \"Any\", and choose \"Created in the App\" from the remaining drop-down. Update the search macros as necessary. Update Index Macros \u00b6 Update the index specific macros to the indexes being used for the Pi-hole data. Updating these to the correct values will increase performance of searches. Macro Default Description Example Value pihole_index index=* Update to the specific index being used for the \"pihole\" sourcetype. index=dns pihole_dhcp_index `pihole_index` Update to the specific index being used for the \"pihole:dhcp\" sourcetype, if different from the main pihole index. index=dhcp pihole_blocklist_index `pihole_index` Update to the index set in the scripted input from the Pihole DNS Add-on. index=dns_system pihole_system_index `pihole_index` Update to the specific index being used for the \"pihole:system\" sourcetype created from the system summary events modular input. see Pihole Add-on: Modular Inputs . index=dns_system pihole_filter_index `pihole_index` Update to the specific index being used for the pihole:filters sourcetype created from the filters modular input. see Pihole Add-on: Modular Inputs . index=dns_system Update Search Related Macros \u00b6 Update this search macro only if you are using DMA . see Configure Data Model Acceleration for more information. Warning Updating this macro to \"true\" without first enabling data model acceleration will cause the searches in dashboards to fail or have no results. Macro Default Description Example Value pihole_summariesonly summariesonly=false Defaults to not using summarized data from the CIM. Set to \"true\" if using data model acceleration. summariesonly=true Update Lookup Macros \u00b6 Update the following search macros if you are utilizing a custom lookup for hostname enrichment. If you are using the default lookup included in this app, do not modify the following. see Configure Enrichment for more information. Macro Default Description Example Value pihole_host_lookup_name pihole_dhcp_lease_lookup Update to the name of the CSV file you are using. my_pihole_lookup.csv pihole_lookup_field_ip dest_ip Update only if you are not using the default field for IPs. client_ip pihole_lookup_field_hostname dest_nt_host Update only if you are not using the default field for hostnames client_name pihole_lookup_field_mac dest_mac Update only if you are not using the default field for mac addresses. client_mac Troubleshooting \u00b6 After saving the search macros, navigate back to the Pihole DNS app and you should now see the \"Hostname\" field being populated. If not, see Troubleshooting Enrichment .","title":"Update Macros"},{"location":"getting-started/configure/configure-macros/#update-search-macros","text":"Recommended Step To ensure this App functions efficiently, it is important to update a few search macros. Change the following macros to their appropriate values. For more information on the search macros used in this app, see Search Macros Reference .","title":"Update Search Macros"},{"location":"getting-started/configure/configure-macros/#how-to-update-macros","text":"Open the Pihole DNS app for Splunk. Navigate to Settings > Advanced Search > Search macros. Not seeing any results If no results are found, be sure that the \"App\" context is set to the Pihole DNS app, owner is set to \"Any\", and choose \"Created in the App\" from the remaining drop-down. Update the search macros as necessary.","title":"How to Update Macros"},{"location":"getting-started/configure/configure-macros/#update-index-macros","text":"Update the index specific macros to the indexes being used for the Pi-hole data. Updating these to the correct values will increase performance of searches. Macro Default Description Example Value pihole_index index=* Update to the specific index being used for the \"pihole\" sourcetype. index=dns pihole_dhcp_index `pihole_index` Update to the specific index being used for the \"pihole:dhcp\" sourcetype, if different from the main pihole index. index=dhcp pihole_blocklist_index `pihole_index` Update to the index set in the scripted input from the Pihole DNS Add-on. index=dns_system pihole_system_index `pihole_index` Update to the specific index being used for the \"pihole:system\" sourcetype created from the system summary events modular input. see Pihole Add-on: Modular Inputs . index=dns_system pihole_filter_index `pihole_index` Update to the specific index being used for the pihole:filters sourcetype created from the filters modular input. see Pihole Add-on: Modular Inputs . index=dns_system","title":"Update Index Macros"},{"location":"getting-started/configure/configure-macros/#update-search-related-macros","text":"Update this search macro only if you are using DMA . see Configure Data Model Acceleration for more information. Warning Updating this macro to \"true\" without first enabling data model acceleration will cause the searches in dashboards to fail or have no results. Macro Default Description Example Value pihole_summariesonly summariesonly=false Defaults to not using summarized data from the CIM. Set to \"true\" if using data model acceleration. summariesonly=true","title":"Update Search Related Macros"},{"location":"getting-started/configure/configure-macros/#update-lookup-macros","text":"Update the following search macros if you are utilizing a custom lookup for hostname enrichment. If you are using the default lookup included in this app, do not modify the following. see Configure Enrichment for more information. Macro Default Description Example Value pihole_host_lookup_name pihole_dhcp_lease_lookup Update to the name of the CSV file you are using. my_pihole_lookup.csv pihole_lookup_field_ip dest_ip Update only if you are not using the default field for IPs. client_ip pihole_lookup_field_hostname dest_nt_host Update only if you are not using the default field for hostnames client_name pihole_lookup_field_mac dest_mac Update only if you are not using the default field for mac addresses. client_mac","title":"Update Lookup Macros"},{"location":"getting-started/configure/configure-macros/#troubleshooting","text":"After saving the search macros, navigate back to the Pihole DNS app and you should now see the \"Hostname\" field being populated. If not, see Troubleshooting Enrichment .","title":"Troubleshooting"},{"location":"getting-started/troubleshooting/troubleshoot-enrichment/","text":"Troubleshoot Enrichment \u00b6 Common Problems \u00b6 Permission Issue \u00b6 The most common problem with not seeing hostnames populated is that the permissions for the lookup file are not correct. Check the following. In Splunk Web, Navigate to Settings > Lookups > Lookup table files. Search for the name of your lookup file. Verify the permissions for the file by clicking \"Permissions.\" Be sure \"All apps (system)\" is selected. Be sure \"Read\" permissions is granted to Everyone. If you are utilizing a lookup definition, perform the same steps for the definition. Search Macro Definition \u00b6 Check the modified lookup search macros for accuracy. It may be possible that there is a typo in the changed values. See Update Macros in this documentation for more information.","title":"Troubleshoot Enrichment"},{"location":"getting-started/troubleshooting/troubleshoot-enrichment/#troubleshoot-enrichment","text":"","title":"Troubleshoot Enrichment"},{"location":"getting-started/troubleshooting/troubleshoot-enrichment/#common-problems","text":"","title":"Common Problems"},{"location":"getting-started/troubleshooting/troubleshoot-enrichment/#permission-issue","text":"The most common problem with not seeing hostnames populated is that the permissions for the lookup file are not correct. Check the following. In Splunk Web, Navigate to Settings > Lookups > Lookup table files. Search for the name of your lookup file. Verify the permissions for the file by clicking \"Permissions.\" Be sure \"All apps (system)\" is selected. Be sure \"Read\" permissions is granted to Everyone. If you are utilizing a lookup definition, perform the same steps for the definition.","title":"Permission Issue"},{"location":"getting-started/troubleshooting/troubleshoot-enrichment/#search-macro-definition","text":"Check the modified lookup search macros for accuracy. It may be possible that there is a typo in the changed values. See Update Macros in this documentation for more information.","title":"Search Macro Definition"},{"location":"reference/reference-macros/","text":"Search Macro Reference \u00b6 Macro Default Description pihole_index index=* Update to the specific index being used for the \"pihole\" sourcetype. pihole_dhcp_index `pihole_index` Update to the specific index being used for the \"pihole:dhcp\" sourcetype, if different from the main pihole index. pihole_blocklist_index `pihole_index` Update to the index set in the scripted input from the Pihole DNS Add-on. pihole_system_index `pihole_index` Update to the specific index being used for the \"pihole:system\" sourcetype created from the system summary events modular input. see Pihole Add-on: Modular Inputs . pihole_filter_index `pihole_index` Update to the specific index being used for the pihole:filters sourcetype created from the filters modular input. see Pihole Add-on: Modular Inputs . pihole_summariesonly summariesonly=false Defaults to not using summarized data from the CIM. Set to \"true\" if using data model acceleration. pihole_host_lookup_name pihole_dhcp_lease_lookup Default Lookup used to map IPs to hostnames. pihole_lookup_field_ip dest_ip Default ip field for the lookup to map IPs to hostnames. pihole_lookup_field_hostname dest_nt_hostname Default hostname field for the lookup to map IPs to hostnames. pihole_lookup_field_mac dest_mac Default mac field for the lookup to map IPs to hostnames. pihole_enrich_rename rename `pihole_lookup_field_hostname` as \"dest_nt_host\", `pihole_lookup_field_ip` as \"dest_ip\" Used by app to rename lookup fields. pihole_enrich_hostname(1) lookup `pihole_host_lookup_name` `pihole_lookup_field_ip` as \"$ip_field$\" OUTPUTNEW `pihole_lookup_field_hostname` as Hostname Used by app to enrich data with hostnames. pihole_enrich_blocklist(1) lookup pihole_blocklist_lookup domain as \"$domain_field$\" OUTPUTNEW blocklist Used by app to enrich data with blocklist used.","title":"Search Macros Used"},{"location":"reference/reference-macros/#search-macro-reference","text":"Macro Default Description pihole_index index=* Update to the specific index being used for the \"pihole\" sourcetype. pihole_dhcp_index `pihole_index` Update to the specific index being used for the \"pihole:dhcp\" sourcetype, if different from the main pihole index. pihole_blocklist_index `pihole_index` Update to the index set in the scripted input from the Pihole DNS Add-on. pihole_system_index `pihole_index` Update to the specific index being used for the \"pihole:system\" sourcetype created from the system summary events modular input. see Pihole Add-on: Modular Inputs . pihole_filter_index `pihole_index` Update to the specific index being used for the pihole:filters sourcetype created from the filters modular input. see Pihole Add-on: Modular Inputs . pihole_summariesonly summariesonly=false Defaults to not using summarized data from the CIM. Set to \"true\" if using data model acceleration. pihole_host_lookup_name pihole_dhcp_lease_lookup Default Lookup used to map IPs to hostnames. pihole_lookup_field_ip dest_ip Default ip field for the lookup to map IPs to hostnames. pihole_lookup_field_hostname dest_nt_hostname Default hostname field for the lookup to map IPs to hostnames. pihole_lookup_field_mac dest_mac Default mac field for the lookup to map IPs to hostnames. pihole_enrich_rename rename `pihole_lookup_field_hostname` as \"dest_nt_host\", `pihole_lookup_field_ip` as \"dest_ip\" Used by app to rename lookup fields. pihole_enrich_hostname(1) lookup `pihole_host_lookup_name` `pihole_lookup_field_ip` as \"$ip_field$\" OUTPUTNEW `pihole_lookup_field_hostname` as Hostname Used by app to enrich data with hostnames. pihole_enrich_blocklist(1) lookup pihole_blocklist_lookup domain as \"$domain_field$\" OUTPUTNEW blocklist Used by app to enrich data with blocklist used.","title":"Search Macro Reference"},{"location":"reference/releases/","text":"Release notes for the Pi-hole app for Splunk \u00b6 v2.2.2 Jan 14, 2022 \u00b6 New Features \u00b6 Updated search dashboard to allow filtering of pie charts based of query input. Deprecating all knowledge objects for blocklist activity. This feature will be brought back with v6 of Pi-hole. Added ability to search by host in dashboards. Transaction search dashboard will now show if the CNAME was blocked. Known issues \u00b6 This version of the Pi-hole app for Splunk has the following known issues. If no issues appear here, no issues have been reported. Issues can be reported on the Pi-hole DNS app for Splunk's Github page .","title":"Release Notes"},{"location":"reference/releases/#release-notes-for-the-pi-hole-app-for-splunk","text":"","title":"Release notes for the Pi-hole app for Splunk"},{"location":"reference/releases/#v222-jan-14-2022","text":"","title":"v2.2.2 Jan 14, 2022"},{"location":"reference/releases/#new-features","text":"Updated search dashboard to allow filtering of pie charts based of query input. Deprecating all knowledge objects for blocklist activity. This feature will be brought back with v6 of Pi-hole. Added ability to search by host in dashboards. Transaction search dashboard will now show if the CNAME was blocked.","title":"New Features"},{"location":"reference/releases/#known-issues","text":"This version of the Pi-hole app for Splunk has the following known issues. If no issues appear here, no issues have been reported. Issues can be reported on the Pi-hole DNS app for Splunk's Github page .","title":"Known issues"},{"location":"reference/releases/release-history/","text":"Release history for the Pi-hole DNS app for Splunk \u00b6 The latest version of the Pi-hole DNS app for Splunk is version 2.2.2. See Release notes for the Pi-hole DNS app for Splunk of the latest version. v2.2.1 June 7, 2021 \u00b6 Fixed error in stats command error on Splunk version 8.2.0 - #38 added version to dashboards to support jQuery v3.5 v2.2.0 May 12, 2021 \u00b6 Fixed issue causing DNS search dashboard to not populate from a custom lookup -> #35 Made DHCP lookup simpiler and removed excess saved searches related to the DHCP lookup. v2.1.9 April 28, 2021 \u00b6 Added macro for filter index. Created new view \"Pihole Filters.\" This dashboard displays the regex and exact filters created in the Pi-hole server. This requires modular inputs to be setup on the Pihole DNS add-on. see Pihole Add-on: Modular Inputs for more information. Created new view \"Filter Tester.\" This dashboard will help test regex and exact filters before you implement them on the Pi-hole. v2.1.8 Feb 21, 2021 \u00b6 Removed spaces from pihole_summariesonly search macro causing dashboards to have the error \"Error in 'tstats' command: Option '=' is invalid.\" (Introduced in Version 2.1.6) - #31 Added ability to see which lists a blocked query belongs to. This requires version 1.2.8 or later of the Pihole DNS Add-on. Added Default value on Pihole Overview dashboard for API host selection. v2.1.7 Feb 20, 2021 \u00b6 Added ability to see which lists a blocked query belongs to. This requires version 1.2.8 or later of the Pihole DNS Add-on. Added Default value on Pihole Overview dashboard for API host selection. v2.1.6 Jan 26, 2021 \u00b6 Added dropdown on the Pihole DNS search dashboard populated by DHCP entries #18 (@mljdivemaster) Added ability to filter by Pi-hole in dashboards #17 Added macro to control summary indexes when utilizing tstats Added Top Queries Allowed/Blocked by Source on the Pihole DNS search Dashboard Updated the Pihole DNS search dashboard table to reduce the amount of \"unknown\" values. Updated the Pihole Query Log dashboard table to reduce the amount of \"unknown\" values. Also, updated field names for clarity. Fixed Typos in token on the Pihole DNS search dashboard. Fixed search on the Pihole Transaction dashboard which prevented no information to display on the force directed panel. v2.1.5 Dec 21, 2020 \u00b6 Updated Pihole Overview dashboard to include data from the modular input of the TA-pihole_dns add-on. Updated DHCP enrichment macro to be simpler. v2.1.4 Oct 31, 2020 \u00b6 Incomplete eval statement on Query log dashboard causing the \"Host\" field to be missing. Missing \"Transaction ID\" field on Query log dashbaord v2.1.3 Sept 1, 2020 \u00b6 Added DHCP Overview Dashboard. If DHCP is being used, IP address will be enriched with hostnames. Added select enhancements to dashboards. New requirement added for Status Indicator - Custom Visualization. New requirement for populating DHCP hostnames (if DHCP is being used). v2.1.2 July 27, 2020 \u00b6 Fixed broken Drilldown on DNS Search Dashboard.","title":"Release History"},{"location":"reference/releases/release-history/#release-history-for-the-pi-hole-dns-app-for-splunk","text":"The latest version of the Pi-hole DNS app for Splunk is version 2.2.2. See Release notes for the Pi-hole DNS app for Splunk of the latest version.","title":"Release history for the Pi-hole DNS app for Splunk"},{"location":"reference/releases/release-history/#v221-june-7-2021","text":"Fixed error in stats command error on Splunk version 8.2.0 - #38 added version to dashboards to support jQuery v3.5","title":"v2.2.1 June 7, 2021"},{"location":"reference/releases/release-history/#v220-may-12-2021","text":"Fixed issue causing DNS search dashboard to not populate from a custom lookup -> #35 Made DHCP lookup simpiler and removed excess saved searches related to the DHCP lookup.","title":"v2.2.0 May 12, 2021"},{"location":"reference/releases/release-history/#v219-april-28-2021","text":"Added macro for filter index. Created new view \"Pihole Filters.\" This dashboard displays the regex and exact filters created in the Pi-hole server. This requires modular inputs to be setup on the Pihole DNS add-on. see Pihole Add-on: Modular Inputs for more information. Created new view \"Filter Tester.\" This dashboard will help test regex and exact filters before you implement them on the Pi-hole.","title":"v2.1.9 April 28, 2021"},{"location":"reference/releases/release-history/#v218-feb-21-2021","text":"Removed spaces from pihole_summariesonly search macro causing dashboards to have the error \"Error in 'tstats' command: Option '=' is invalid.\" (Introduced in Version 2.1.6) - #31 Added ability to see which lists a blocked query belongs to. This requires version 1.2.8 or later of the Pihole DNS Add-on. Added Default value on Pihole Overview dashboard for API host selection.","title":"v2.1.8 Feb 21, 2021"},{"location":"reference/releases/release-history/#v217-feb-20-2021","text":"Added ability to see which lists a blocked query belongs to. This requires version 1.2.8 or later of the Pihole DNS Add-on. Added Default value on Pihole Overview dashboard for API host selection.","title":"v2.1.7 Feb 20, 2021"},{"location":"reference/releases/release-history/#v216-jan-26-2021","text":"Added dropdown on the Pihole DNS search dashboard populated by DHCP entries #18 (@mljdivemaster) Added ability to filter by Pi-hole in dashboards #17 Added macro to control summary indexes when utilizing tstats Added Top Queries Allowed/Blocked by Source on the Pihole DNS search Dashboard Updated the Pihole DNS search dashboard table to reduce the amount of \"unknown\" values. Updated the Pihole Query Log dashboard table to reduce the amount of \"unknown\" values. Also, updated field names for clarity. Fixed Typos in token on the Pihole DNS search dashboard. Fixed search on the Pihole Transaction dashboard which prevented no information to display on the force directed panel.","title":"v2.1.6 Jan 26, 2021"},{"location":"reference/releases/release-history/#v215-dec-21-2020","text":"Updated Pihole Overview dashboard to include data from the modular input of the TA-pihole_dns add-on. Updated DHCP enrichment macro to be simpler.","title":"v2.1.5 Dec 21, 2020"},{"location":"reference/releases/release-history/#v214-oct-31-2020","text":"Incomplete eval statement on Query log dashboard causing the \"Host\" field to be missing. Missing \"Transaction ID\" field on Query log dashbaord","title":"v2.1.4 Oct 31, 2020"},{"location":"reference/releases/release-history/#v213-sept-1-2020","text":"Added DHCP Overview Dashboard. If DHCP is being used, IP address will be enriched with hostnames. Added select enhancements to dashboards. New requirement added for Status Indicator - Custom Visualization. New requirement for populating DHCP hostnames (if DHCP is being used).","title":"v2.1.3 Sept 1, 2020"},{"location":"reference/releases/release-history/#v212-july-27-2020","text":"Fixed broken Drilldown on DNS Search Dashboard.","title":"v2.1.2 July 27, 2020"}]}